{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 22, "column": 0}, "map": {"version":3,"sources":["file:///Users/charlespelong/Desktop/finance-type/my-cv-app/pages/api/cv/delete.ts"],"sourcesContent":["import type { NextApiHandler } from 'next'\nimport { createPagesServerClient } from '@supabase/auth-helpers-nextjs'\n\nconst handler: NextApiHandler = async (req, res) => {\n  if (req.method !== 'DELETE') {\n    res.setHeader('Allow', ['DELETE'])\n    return res.status(405).json({ error: 'Méthode non autorisée' })\n  }\n\n  const { id } = req.query\n  if (typeof id !== 'string') {\n    return res.status(400).json({ error: 'Identifiant manquant.' })\n  }\n\n  const supabase = createPagesServerClient({ req, res })\n  const {\n    data: { session },\n  } = await supabase.auth.getSession()\n\n  if (!session?.user) {\n    return res.status(401).json({ error: 'Authentification requise.' })\n  }\n\n  const { error } = await supabase\n    .from('user_cvs')\n    .delete({ returning: 'minimal' })\n    .eq('id', id)\n    .eq('user_id', session.user.id)\n\n  if (error) {\n    return res.status(500).json({ error: error.message })\n  }\n\n  return res.status(200).json({ success: true })\n}\n\nexport default handler\n"],"names":[],"mappings":";;;;AACA;;AAEA,MAAM,UAA0B,OAAO,KAAK;IAC1C,IAAI,IAAI,MAAM,KAAK,UAAU;QAC3B,IAAI,SAAS,CAAC,SAAS;YAAC;SAAS;QACjC,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IAC/D;IAEA,MAAM,EAAE,EAAE,EAAE,GAAG,IAAI,KAAK;IACxB,IAAI,OAAO,OAAO,UAAU;QAC1B,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAAwB;IAC/D;IAEA,MAAM,WAAW,IAAA,kMAAuB,EAAC;QAAE;QAAK;IAAI;IACpD,MAAM,EACJ,MAAM,EAAE,OAAO,EAAE,EAClB,GAAG,MAAM,SAAS,IAAI,CAAC,UAAU;IAElC,IAAI,CAAC,SAAS,MAAM;QAClB,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO;QAA4B;IACnE;IAEA,MAAM,EAAE,KAAK,EAAE,GAAG,MAAM,SACrB,IAAI,CAAC,YACL,MAAM,CAAC;QAAE,WAAW;IAAU,GAC9B,EAAE,CAAC,MAAM,IACT,EAAE,CAAC,WAAW,QAAQ,IAAI,CAAC,EAAE;IAEhC,IAAI,OAAO;QACT,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;YAAE,OAAO,MAAM,OAAO;QAAC;IACrD;IAEA,OAAO,IAAI,MAAM,CAAC,KAAK,IAAI,CAAC;QAAE,SAAS;IAAK;AAC9C;uCAEe","debugId":null}}]
}