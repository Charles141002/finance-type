{"version":3,"sources":["turbopack:///[project]/Desktop/finance-type/my-cv-app/utils/types.ts","turbopack:///[project]/Desktop/finance-type/my-cv-app/components/BlockEditor.tsx","turbopack:///[project]/Desktop/finance-type/my-cv-app/utils/blocksToHTML.ts","turbopack:///[project]/Desktop/finance-type/my-cv-app/utils/cvStyles.ts","turbopack:///[project]/Desktop/finance-type/my-cv-app/data/initialCV.tsx","turbopack:///[project]/Desktop/finance-type/my-cv-app/pages/cv.tsx","turbopack:///[project]/Desktop/finance-type/my-cv-app/node_modules/next/dist/src/build/templates/pages.ts"],"sourcesContent":["export type BlockType =\n  | \"header\"\n  | \"subsection\"\n  | \"section\"\n  | \"text\"\n  | \"contact\"\n  | \"divider\";\n\nexport interface Block {\n  id: string;\n  type: BlockType;\n  content?: any;\n  children?: Block[];\n  style?: {\n    size?: \"small\" | \"medium\" | \"large\";\n    align?: \"left\" | \"center\" | \"right\";\n    italic?: boolean;\n  };\n}\n\nexport interface DragContext {\n  source: {\n    blockId: string;\n    parentId?: string;\n    blockType: BlockType;\n    index: number;\n  };\n  destination: {\n    parentId?: string;\n    index: number;\n  };\n}\n\n// D√©finition des parents autoris√©s pour chaque type de bloc\n// undefined = niveau racine\nconst ALLOWED_PARENTS: Record<BlockType, Array<BlockType | undefined>> = {\n  header: [undefined],\n  contact: [undefined],\n  divider: [undefined],\n  section: [undefined],\n  subsection: [\"section\"],\n  text: [undefined, \"section\", \"subsection\"],\n};\n\nexport const getAllowedChildTypesForParent = (\n  parentType?: BlockType\n): BlockType[] => {\n  const entries = Object.entries(ALLOWED_PARENTS) as Array<[\n    BlockType,\n    Array<BlockType | undefined>\n  ]>;\n  return entries\n    .filter(([, allowedParents]) => allowedParents.includes(parentType))\n    .map(([type]) => type);\n};\n\n// Trouver le parent d'un bloc\nexport const findParentOfBlock = (\n  blocks: Block[],\n  targetId: string,\n  parent?: Block\n): Block | undefined => {\n  for (const block of blocks) {\n    if (block.id === targetId) return parent;\n    if (block.children && block.children.length > 0) {\n      const found = findParentOfBlock(block.children, targetId, block);\n      if (found) return found;\n    }\n  }\n  return undefined;\n};\n\nexport const isDescendant = (\n  blocks: Block[],\n  ancestorId: string,\n  potentialDescendantId: string\n): boolean => {\n  const ancestor = findBlockById(blocks, ancestorId);\n  if (!ancestor) return false;\n  const queue = [...(ancestor.children || [])];\n  while (queue.length) {\n    const current = queue.shift()!;\n    if (current.id === potentialDescendantId) return true;\n    if (current.children && current.children.length > 0) {\n      queue.push(...current.children);\n    }\n  }\n  return false;\n};\n\nexport const getDepthOfBlock = (blocks: Block[], blockId: string): number => {\n  const helper = (list: Block[], id: string, depth: number): number => {\n    for (const b of list) {\n      if (b.id === id) return depth;\n      if (b.children && b.children.length > 0) {\n        const d = helper(b.children, id, depth + 1);\n        if (d !== -1) return d;\n      }\n    }\n    return -1;\n  };\n  return helper(blocks, blockId, 0);\n};\n\n// R√®gles de d√©placement strictes et lisibles\nexport const canMoveBlock = (context: DragContext, allBlocks: Block[]): boolean => {\n  const { source, destination } = context;\n\n  // 1) Emp√™cher de d√©placer un bloc dans son propre sous-arbre\n  if (destination.parentId && isDescendant(allBlocks, source.blockId, destination.parentId)) {\n    return false;\n  }\n\n  // 2) D√©terminer le type du parent destination\n  let destinationParentType: BlockType | undefined = undefined;\n  if (destination.parentId) {\n    const parent = findBlockById(allBlocks, destination.parentId);\n    if (!parent) return false;\n    destinationParentType = parent.type;\n  }\n\n  // 3) V√©rifier la compatibilit√© parent/enfant\n  const allowedParents = ALLOWED_PARENTS[source.blockType];\n  if (!allowedParents.includes(destinationParentType)) {\n    return false;\n  }\n\n  // 4) Optionnel: limiter la profondeur totale √† 3 (root=0)\n  const currentDepth = getDepthOfBlock(allBlocks, source.blockId);\n  const destinationDepth = destinationParentType\n    ? getDepthOfBlock(allBlocks, destination.parentId!) + 1\n    : 0;\n  const resultingDepth = destinationDepth; // profondeur du parent apr√®s move; l'enfant sera √† destinationDepth + 1\n  if (resultingDepth + 1 > 3) {\n    return false;\n  }\n\n  return true;\n};\n\nexport const findBlockById = (blocks: Block[], id: string): Block | undefined => {\n  for (const block of blocks) {\n    if (block.id === id) return block;\n    if (block.children) {\n      const found = findBlockById(block.children, id);\n      if (found) return found;\n    }\n  }\n  return undefined;\n};\n\nexport const getAllChildBlocks = (block: Block): Block[] => {\n  const children: Block[] = [];\n  if (block.children) {\n    for (const child of block.children) {\n      children.push(child, ...getAllChildBlocks(child));\n    }\n  }\n  return children;\n};\n","\"use client\";\nimport { useEffect, useRef, useState } from \"react\";\nimport type { CSSProperties } from \"react\";\nimport { DragDropContext, Droppable, Draggable, DropResult, DragStart } from \"@hello-pangea/dnd\";\nimport type { DraggableProvidedDragHandleProps, DraggableLocation } from \"@hello-pangea/dnd\";\nimport { v4 as uuid } from \"uuid\";\nimport { Block, BlockType, DragContext, canMoveBlock, findBlockById, getAllowedChildTypesForParent } from \"../utils/types\";\n\nconst BLOCK_META: Record<\n  BlockType,\n  {\n    label: string;\n    description: string;\n    color: string;\n    icon: string;\n  }\n> = {\n  header: {\n    label: \"En-t√™te\",\n    description: \"Nom principal affich√© tout en haut du CV\",\n    color: \"#2563eb\",\n    icon: \"üë§\",\n  },\n  contact: {\n    label: \"Contact\",\n    description: \"Email, t√©l√©phone, adresse et lien LinkedIn\",\n    color: \"#0f766e\",\n    icon: \"‚úâÔ∏è\",\n  },\n  divider: {\n    label: \"S√©parateur\",\n    description: \"Fine ligne horizontale pour a√©rer le CV\",\n    color: \"#6b7280\",\n    icon: \"‚îÄ\",\n  },\n  section: {\n    label: \"Section\",\n    description: \"Bloc titre pour exp√©riences, formations, etc.\",\n    color: \"#9333ea\",\n    icon: \"üìÇ\",\n  },\n  subsection: {\n    label: \"Sous-section\",\n    description: \"Entr√©e d√©taill√©e √† l'int√©rieur d'une section\",\n    color: \"#f97316\",\n    icon: \"üìÑ\",\n  },\n  text: {\n    label: \"Texte\",\n    description: \"Paragraphe libre ou bullet point\",\n    color: \"#1f2937\",\n    icon: \"‚úèÔ∏è\",\n  },\n};\n\nconst getBlockMeta = (type: BlockType) => BLOCK_META[type];\n\n// Utilitaire simple pour assainir le HTML et ne garder que B/I/U/BR/UL/OL/LI\nconst sanitizeHtml = (html: string): string => {\n  try {\n    const container = document.createElement(\"div\");\n    container.innerHTML = html;\n    // Convertir <b>/<i> -> <strong>/<em> et spans soulign√©s -> <u>\n    const replaceTag = (el: HTMLElement, newTag: string) => {\n      const newEl = document.createElement(newTag);\n      while (el.firstChild) newEl.appendChild(el.firstChild);\n      el.parentNode?.replaceChild(newEl, el);\n      return newEl;\n    };\n    container.querySelectorAll(\"b\").forEach((el) => replaceTag(el as HTMLElement, \"strong\"));\n    container.querySelectorAll(\"i\").forEach((el) => replaceTag(el as HTMLElement, \"em\"));\n    container.querySelectorAll(\"span\").forEach((el) => {\n      const span = el as HTMLElement;\n      const td = span.style.textDecoration || span.getAttribute(\"style\") || \"\";\n      if (td && td.toLowerCase().includes(\"underline\")) {\n        replaceTag(span, \"u\");\n      }\n    });\n    const allowed = new Set([\"STRONG\", \"EM\", \"U\", \"BR\", \"UL\", \"OL\", \"LI\"]);\n    const walk = (node: Node) => {\n      // Supprimer les <script>, <style> et commentaires\n      if (node.nodeType === Node.COMMENT_NODE) {\n        node.parentNode?.removeChild(node);\n        return;\n      }\n      if (node.nodeType === Node.ELEMENT_NODE) {\n        const el = node as HTMLElement;\n        if (!allowed.has(el.tagName)) {\n          // Remplacer l'√©l√©ment par son contenu (unwrap)\n          const parent = el.parentNode;\n          if (!parent) return;\n          while (el.firstChild) parent.insertBefore(el.firstChild, el);\n          parent.removeChild(el);\n          return;\n        } else {\n          // Nettoyer les attributs\n          [...el.attributes].forEach((attr) => el.removeAttribute(attr.name));\n        }\n      }\n      // Parcourir enfants en copie car on peut modifier pendant l'it√©ration\n      const children = Array.from(node.childNodes);\n      children.forEach(walk);\n    };\n    walk(container);\n    return container.innerHTML;\n  } catch {\n    return html;\n  }\n};\n\ninterface RichTextProps {\n  value: string;\n  onChange: (html: string) => void;\n  placeholder?: string;\n  singleLine?: boolean;\n  style?: CSSProperties;\n}\n\nconst RichTextEditor = ({ value, onChange, placeholder, singleLine, style }: RichTextProps) => {\n  const ref = useRef<HTMLDivElement>(null);\n  const lastSelectionRef = useRef<Range | null>(null);\n\n  useEffect(() => {\n    // Mettre √† jour le contenu si la valeur externe change (√©viter boucle infinie)\n    if (ref.current && ref.current.innerHTML !== value) {\n      ref.current.innerHTML = value || \"\";\n    }\n  }, [value]);\n\n  const saveSelection = () => {\n    const sel = window.getSelection();\n    if (sel && sel.rangeCount > 0) {\n      lastSelectionRef.current = sel.getRangeAt(0);\n    }\n  };\n\n  const restoreSelection = () => {\n    const sel = window.getSelection();\n    if (sel && lastSelectionRef.current) {\n      sel.removeAllRanges();\n      sel.addRange(lastSelectionRef.current);\n    }\n  };\n\n  const exec = (cmd: string) => {\n    // Emp√™cher le bouton de perdre le focus\n    restoreSelection();\n    ref.current?.focus();\n    document.execCommand(cmd);\n    // D√©clencher onChange\n    const html = sanitizeHtml(ref.current?.innerHTML || \"\");\n    if (html !== value) onChange(html);\n  };\n\n  const execArg = (cmd: string, arg?: string) => {\n    restoreSelection();\n    ref.current?.focus();\n    document.execCommand(cmd, false, arg);\n    const html = sanitizeHtml(ref.current?.innerHTML || \"\");\n    if (html !== value) onChange(html);\n  };\n\n  const insertHTML = (htmlSnippet: string) => {\n    execArg(\"insertHTML\", htmlSnippet);\n  };\n\n  const isInsideList = (): boolean => {\n    const sel = window.getSelection();\n    const node = sel?.anchorNode as Node | null;\n    let current: Node | null = node;\n    while (current) {\n      if ((current as HTMLElement).tagName) {\n        const tag = ((current as HTMLElement).tagName || \"\").toUpperCase();\n        if (tag === \"LI\" || tag === \"UL\" || tag === \"OL\") return true;\n      }\n      current = current.parentNode;\n    }\n    return false;\n  };\n\n  const onInput = () => {\n    const html = sanitizeHtml(ref.current?.innerHTML || \"\");\n    if (html !== value) onChange(html);\n  };\n\n  const onKeyDown: React.KeyboardEventHandler<HTMLDivElement> = (e) => {\n    // Emp√™cher retour chariot en mode singleLine\n    if (singleLine && e.key === \"Enter\") {\n      e.preventDefault();\n      return;\n    }\n    // Shift+Enter => saut de ligne doux (br)\n    if (!singleLine && e.key === \"Enter\" && e.shiftKey) {\n      e.preventDefault();\n      insertHTML(\"<br>\");\n      return;\n    }\n    // Enter sans Shift: en dehors d'une liste, ins√©rer un <br>\n    if (!singleLine && e.key === \"Enter\" && !e.shiftKey) {\n      if (!isInsideList()) {\n        e.preventDefault();\n        insertHTML(\"<br>\");\n        return;\n      }\n    }\n  };\n\n  const toolbarBtnStyle: CSSProperties = {\n    padding: \"2px 6px\",\n    border: \"1px solid #d1d5db\",\n    borderRadius: 4,\n    background: \"#fff\",\n    fontSize: 12,\n    cursor: \"pointer\",\n  };\n\n  return (\n    <div>\n      <div style={{ display: \"flex\", gap: 6, marginBottom: 6, flexWrap: \"wrap\" }}>\n        <button type=\"button\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"bold\")}>\n          B\n        </button>\n        <button type=\"button\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"italic\")}>\n          I\n        </button>\n        <button type=\"button\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"underline\")}>\n          U\n        </button>\n        <span style={{ width: 8 }} />\n        <button type=\"button\" title=\"Liste √† puces\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"insertUnorderedList\")}>\n          ‚Ä¢\n        </button>\n        <button type=\"button\" title=\"Liste num√©rot√©e\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"insertOrderedList\")}>\n          1.\n        </button>\n        <button type=\"button\" title=\"Augmenter le retrait\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"indent\")}>\n          ‚Üí\n        </button>\n        <button type=\"button\" title=\"Diminuer le retrait\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => exec(\"outdent\")}>\n          ‚Üê\n        </button>\n        <span style={{ width: 8 }} />\n        <button type=\"button\" title=\"Ins√©rer tiret demi-cadratin\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => insertHTML(\"‚Äì \")}>‚Äì</button>\n        <button type=\"button\" title=\"Ins√©rer tiret cadratin\" style={toolbarBtnStyle} onMouseDown={(e) => e.preventDefault()} onClick={() => insertHTML(\"‚Äî \")}>‚Äî</button>\n      </div>\n      <div\n        ref={ref}\n        contentEditable\n        suppressContentEditableWarning\n        onInput={onInput}\n        onKeyDown={onKeyDown}\n        onKeyUp={saveSelection}\n        onMouseUp={saveSelection}\n        onBlur={saveSelection}\n        style={{\n          minHeight: singleLine ? 28 : 60,\n          border: \"1px solid #d1d5db\",\n          borderRadius: 4,\n          padding: 8,\n          background: \"#fff\",\n          outline: \"none\",\n          whiteSpace: singleLine ? \"nowrap\" : \"pre-wrap\",\n          overflow: \"auto\",\n          transition: \"border-color 0.2s ease, box-shadow 0.2s ease\",\n          ...style,\n        }}\n        data-editor=\"true\"\n        data-placeholder={placeholder}\n      />\n      <style>{`\n        [contenteditable][data-placeholder]:empty:before {\n          content: attr(data-placeholder);\n          color: #9ca3af;\n        }\n        [data-editor=\"true\"]:focus {\n          border-color: #3b82f6 !important;\n          box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.14);\n        }\n      `}</style>\n    </div>\n  );\n};\n\ninterface Props {\n  blocks: Block[];\n  setBlocks: (blocks: Block[]) => void;\n  scrollContainerRef?: React.RefObject<HTMLDivElement | null>;\n}\n\nconst BlockEditor = ({ blocks, setBlocks, scrollContainerRef }: Props) => {\n  const [subBlockTypes, setSubBlockTypes] = useState<Record<string, BlockType>>({});\n  const [dragError, setDragError] = useState<string | null>(null);\n  const [isDragging, setIsDragging] = useState<boolean>(false);\n  const mouseYRef = useRef<number>(0);\n  const autoScrollTimerRef = useRef<number | null>(null);\n  const [draggingBlockType, setDraggingBlockType] = useState<BlockType | null>(null);\n  const [subtitleVisible, setSubtitleVisible] = useState<Record<string, boolean>>({});\n  const [periodVisible, setPeriodVisible] = useState<Record<string, boolean>>({});\n  const [collapsedBlocks, setCollapsedBlocks] = useState<Record<string, boolean>>({});\n  const hasInitializedCollapse = useRef(false);\n  useEffect(() => {\n    if (hasInitializedCollapse.current || blocks.length === 0) return;\n    const initial: Record<string, boolean> = {};\n    const visit = (list: Block[]) => {\n      list.forEach((block) => {\n        initial[block.id] = true;\n        if (block.children && block.children.length > 0) visit(block.children);\n      });\n    };\n    visit(blocks);\n    setCollapsedBlocks(initial);\n    hasInitializedCollapse.current = true;\n  }, [blocks]);\n  const [highlightedBlockId, setHighlightedBlockId] = useState<string | null>(null);\n\n  useEffect(() => {\n    if (!highlightedBlockId) return;\n    const el = document.querySelector(\n      `[data-block-id=\"${highlightedBlockId}\"]`\n    ) as HTMLElement | null;\n    if (!el) return;\n\n    el.scrollIntoView({ behavior: \"smooth\", block: \"center\" });\n    el.classList.add(\"block-editor__pulse\");\n    const timer = window.setTimeout(() => {\n      el.classList.remove(\"block-editor__pulse\");\n      setHighlightedBlockId(null);\n    }, 1400);\n\n    return () => {\n      el.classList.remove(\"block-editor__pulse\");\n      window.clearTimeout(timer);\n    };\n  }, [highlightedBlockId]);\n\n  const hasMeaningfulText = (html: string | undefined): boolean => {\n    if (!html) return false;\n    const plain = html.replace(/<[^>]*>/g, \"\").replace(/\\u00A0/g, \" \").trim();\n    return /[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø0-9]/.test(plain);\n  };\n\n  // Gestion auto-scroll pendant le drag dans le conteneur scrollable gauche\n  useEffect(() => {\n    const handleMouseMove = (e: MouseEvent) => {\n      mouseYRef.current = e.clientY;\n    };\n    if (isDragging) {\n      window.addEventListener(\"mousemove\", handleMouseMove);\n      if (autoScrollTimerRef.current == null) {\n        autoScrollTimerRef.current = window.setInterval(() => {\n          const container = scrollContainerRef?.current;\n          if (!container) return;\n          const rect = container.getBoundingClientRect();\n          const y = mouseYRef.current;\n          const threshold = 80; // px\n          const scrollStep = 16; // px per tick\n          if (y > rect.bottom - threshold) {\n            container.scrollTop += scrollStep;\n          } else if (y < rect.top + threshold) {\n            container.scrollTop -= scrollStep;\n          }\n        }, 16);\n      }\n    } else {\n      window.removeEventListener(\"mousemove\", handleMouseMove);\n      if (autoScrollTimerRef.current != null) {\n        window.clearInterval(autoScrollTimerRef.current);\n        autoScrollTimerRef.current = null;\n      }\n    }\n    return () => {\n      window.removeEventListener(\"mousemove\", handleMouseMove);\n      if (autoScrollTimerRef.current != null) {\n        window.clearInterval(autoScrollTimerRef.current);\n        autoScrollTimerRef.current = null;\n      }\n    };\n  }, [isDragging, scrollContainerRef]);\n\n  // -------------------\n  // Ajouter un bloc\n  // -------------------\n  const handleAddBlock = (parentId?: string, explicitType?: BlockType) => {\n    const typeToUse =\n      explicitType ||\n      (parentId ? subBlockTypes[parentId] || \"text\" : \"text\");\n\n    // R√®gles: v√©rifier que le type est autoris√© pour ce parent\n    const parentType = parentId ? findBlockById(blocks, parentId)?.type : undefined;\n    const allowed = getAllowedChildTypesForParent(parentType);\n    if (!allowed.includes(typeToUse)) {\n      setDragError(\"Type de bloc non autoris√© ici\");\n      setTimeout(() => setDragError(null), 1800);\n      return;\n    }\n    const newBlock: Block = {\n      id: uuid(),\n      type: typeToUse,\n      content:\n        typeToUse === \"contact\"\n          ? { email: \"\", phone: \"\", address: \"\", linkedin: \"\" }\n          : typeToUse === \"divider\"\n          ? undefined\n          : \"\",\n      children: getAllowedChildTypesForParent(typeToUse).length > 0 ? [] : undefined,\n    };\n\n    const updatedBlocks = !parentId\n      ? [...blocks, newBlock]\n      : addChildRecursive(blocks, parentId, newBlock);\n\n    setBlocks(updatedBlocks);\n    setCollapsedBlocks((prev) => ({\n      ...prev,\n      [newBlock.id]: false,\n      ...(parentId ? { [parentId]: false } : {}),\n    }));\n    setHighlightedBlockId(newBlock.id);\n  };\n\n  const addChildRecursive = (blocks: Block[], parentId: string, child: Block): Block[] =>\n    blocks.map((b) => {\n      if (b.id === parentId) {\n        return { ...b, children: [...(b.children || []), child] };\n      }\n      if (b.children) {\n        return { ...b, children: addChildRecursive(b.children, parentId, child) };\n      }\n      return b;\n    });\n\n  const cloneBlockWithNewIds = (block: Block): Block => ({\n    ...block,\n    id: uuid(),\n    children: block.children?.map(cloneBlockWithNewIds) ?? [],\n  });\n\n  const duplicateBlockRecursive = (\n    blocksList: Block[],\n    targetId: string\n  ): { blocks: Block[]; cloneId: string | null } => {\n    let cloneId: string | null = null;\n    const nextBlocks: Block[] = [];\n\n    for (const block of blocksList) {\n      if (block.id === targetId) {\n        const cloned = cloneBlockWithNewIds(block);\n        cloneId = cloned.id;\n        nextBlocks.push(block, cloned);\n        continue;\n      }\n\n      if (block.children && block.children.length > 0) {\n        const { blocks: updatedChildren, cloneId: childCloneId } = duplicateBlockRecursive(\n          block.children,\n          targetId\n        );\n        if (childCloneId) {\n          cloneId = childCloneId;\n          nextBlocks.push({ ...block, children: updatedChildren });\n          continue;\n        }\n        nextBlocks.push(block);\n        continue;\n      }\n\n      nextBlocks.push(block);\n    }\n\n    return { blocks: nextBlocks, cloneId };\n  };\n\n  const handleDuplicateBlock = (id: string) => {\n    const { blocks: updatedBlocks, cloneId } = duplicateBlockRecursive(blocks, id);\n    setBlocks(updatedBlocks);\n    if (cloneId) {\n      setCollapsedBlocks((prev) => ({ ...prev, [cloneId]: false }));\n      setHighlightedBlockId(cloneId);\n    }\n  };\n\n  // -------------------\n  // Supprimer un bloc\n  // -------------------\n  const deleteBlockRecursive = (blocks: Block[], id: string): Block[] =>\n    blocks\n      .filter((b) => b.id !== id)\n      .map((b) =>\n        b.children ? { ...b, children: deleteBlockRecursive(b.children, id) } : b\n      );\n\n  const handleDeleteBlock = (id: string) => setBlocks(deleteBlockRecursive(blocks, id));\n\n  // -------------------\n  // Mise √† jour du contenu\n  // -------------------\n  const updateBlockContentRecursive = (\n    blocksList: Block[],\n    id: string,\n    content: Block[\"content\"]\n  ): Block[] =>\n    blocksList.map((block) => {\n      if (block.id === id) {\n        return { ...block, content };\n      }\n      if (block.children) {\n        return { ...block, children: updateBlockContentRecursive(block.children, id, content) };\n      }\n      return block;\n    });\n\n  const updateBlockContent = (id: string, content: Block[\"content\"]) => {\n    setBlocks(updateBlockContentRecursive(blocks, id, content));\n  };\n\n  // -------------------\n  // Drag & Drop avec r√®gles\n  // -------------------\n  const handleDragEnd = (result: DropResult) => {\n    setIsDragging(false);\n    setDraggingBlockType(null);\n    if (!result.destination) return;\n\n    const { source, destination } = result;\n    \n    // Trouver le bloc source\n    let sourceBlock: Block | undefined;\n    if (source.droppableId === \"root\") {\n      sourceBlock = blocks[source.index];\n    } else {\n      const parentBlock = findBlockById(blocks, source.droppableId);\n      if (parentBlock && parentBlock.children) {\n        sourceBlock = parentBlock.children[source.index];\n      }\n    }\n    \n    if (!sourceBlock) return;\n    \n    // Cr√©er le contexte de d√©placement\n    const dragContext: DragContext = {\n      source: {\n        blockId: sourceBlock.id,\n        parentId: source.droppableId !== \"root\" ? source.droppableId : undefined,\n        blockType: sourceBlock.type,\n        index: source.index\n      },\n      destination: {\n        parentId: destination.droppableId !== \"root\" ? destination.droppableId : undefined,\n        index: destination.index\n      }\n    };\n\n    // V√©rifier les r√®gles de d√©placement\n    if (!canMoveBlock(dragContext, blocks)) {\n      setDragError(\"D√©placement non autoris√© √† cet endroit\");\n      setTimeout(() => setDragError(null), 1800);\n      setIsDragging(false);\n      return;\n    }\n\n    // Effectuer le d√©placement\n    setBlocks(moveBlockWithRules(blocks, result));\n    setIsDragging(false);\n  };\n\n  const handleDragStart = (start: DragStart) => {\n    setIsDragging(true);\n    const b = findBlockById(blocks, start.draggableId);\n    setDraggingBlockType(b?.type || null);\n  };\n\n  // Fonction pour d√©placer un bloc en respectant les r√®gles\n  const moveBlockWithRules = (blocks: Block[], result: DropResult): Block[] => {\n    const { source, destination } = result;\n    \n    if (!destination) return blocks;\n    \n    // Si c'est un d√©placement au niveau racine\n    if (source.droppableId === \"root\" && destination.droppableId === \"root\") {\n      return moveBlockAtRoot(blocks, source.index, destination.index);\n    }\n    \n    // Si c'est un d√©placement dans le m√™me conteneur\n    if (source.droppableId === destination.droppableId) {\n      return moveBlockInContainer(blocks, source.droppableId, source.index, destination.index);\n    }\n    \n    // Si c'est un d√©placement entre conteneurs\n    return moveBlockBetweenContainers(blocks, source, destination);\n  };\n\n  // D√©placer un bloc au niveau racine\n  const moveBlockAtRoot = (blocks: Block[], sourceIndex: number, destIndex: number): Block[] => {\n    const newBlocks = [...blocks];\n    const [movedBlock] = newBlocks.splice(sourceIndex, 1);\n    newBlocks.splice(destIndex, 0, movedBlock);\n    return newBlocks;\n  };\n\n  // D√©placer un bloc dans le m√™me conteneur\n  const moveBlockInContainer = (blocks: Block[], containerId: string, sourceIndex: number, destIndex: number): Block[] => {\n    if (containerId === \"root\") {\n      return moveBlockAtRoot(blocks, sourceIndex, destIndex);\n    }\n    \n    return blocks.map(block => {\n      if (block.id === containerId && block.children) {\n        const newChildren = [...block.children];\n        const [movedChild] = newChildren.splice(sourceIndex, 1);\n        newChildren.splice(destIndex, 0, movedChild);\n        return { ...block, children: newChildren };\n      }\n      if (block.children) {\n        return { ...block, children: moveBlockInContainer(block.children, containerId, sourceIndex, destIndex) };\n      }\n      return block;\n    });\n  };\n\n  // D√©placer un bloc entre conteneurs\n  const moveBlockBetweenContainers = (\n    blocksList: Block[],\n    source: DraggableLocation,\n    destination: DraggableLocation\n  ): Block[] => {\n    // Trouver le bloc √† d√©placer\n    let blockToMove: Block | undefined;\n    \n    if (source.droppableId === \"root\") {\n      blockToMove = blocksList[source.index];\n    } else {\n      const sourceBlock = findBlockById(blocksList, source.droppableId);\n      if (sourceBlock && sourceBlock.children) {\n        blockToMove = sourceBlock.children[source.index];\n      }\n    }\n    \n    if (!blockToMove) return blocksList;\n    \n    // Supprimer le bloc de la source\n    const blocksWithoutSource = removeBlockFromContainer(blocksList, source.droppableId, source.index);\n    \n    // Ajouter le bloc √† la destination\n    return addBlockToContainer(blocksWithoutSource, destination.droppableId, destination.index, blockToMove);\n  };\n\n  // Supprimer un bloc d'un conteneur\n  const removeBlockFromContainer = (blocks: Block[], containerId: string, index: number): Block[] => {\n    if (containerId === \"root\") {\n      return blocks.filter((_, i) => i !== index);\n    }\n    \n    return blocks.map(block => {\n      if (block.id === containerId && block.children) {\n        const newChildren = block.children.filter((_, i) => i !== index);\n        return { ...block, children: newChildren };\n      }\n      if (block.children) {\n        return { ...block, children: removeBlockFromContainer(block.children, containerId, index) };\n      }\n      return block;\n    });\n  };\n\n  // Ajouter un bloc √† un conteneur\n  const addBlockToContainer = (blocks: Block[], containerId: string, index: number, blockToAdd: Block): Block[] => {\n    if (containerId === \"root\") {\n      const newBlocks = [...blocks];\n      newBlocks.splice(index, 0, blockToAdd);\n      return newBlocks;\n    }\n    \n    return blocks.map(block => {\n      if (block.id === containerId) {\n        const newChildren = [...(block.children || [])];\n        newChildren.splice(index, 0, blockToAdd);\n        return { ...block, children: newChildren };\n      }\n      if (block.children) {\n        return { ...block, children: addBlockToContainer(block.children, containerId, index, blockToAdd) };\n      }\n      return block;\n    });\n  };\n\n  // -------------------\n  // Rendu d'un bloc (sans Draggable, g√©r√© par le parent)\n  // -------------------\n  const renderBlock = (\n    block: Block,\n    parentId?: string,\n    handleProps?: DraggableProvidedDragHandleProps | null,\n    isSelfDragging?: boolean\n  ) => {\n    const allowedChildTypes = getAllowedChildTypesForParent(block.type);\n    const canHaveChildren = allowedChildTypes.length > 0;\n    const parentBlock = parentId ? findBlockById(blocks, parentId) : undefined;\n    const isChildOfSubsection = parentBlock?.type === \"subsection\";\n    const meta = getBlockMeta(block.type);\n    const isCollapsed = collapsedBlocks[block.id];\n    const supportsCollapse = block.type !== \"divider\";\n\n    const actionButtonStyle: CSSProperties = {\n      border: \"1px solid #d4d8dd\",\n      backgroundColor: \"#fff\",\n      borderRadius: 6,\n      padding: \"6px 10px\",\n      fontSize: 12,\n      display: \"flex\",\n      alignItems: \"center\",\n      gap: 4,\n      cursor: \"pointer\",\n      color: \"#0f172a\",\n      fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n      transition: \"background-color 0.15s ease, color 0.15s ease\",\n    };\n\n    return (\n      <div\n        data-block-id={block.id}\n        style={{\n          border: `1px solid ${isSelfDragging ? \"#60a5fa\" : \"#e2e8f0\"}`,\n          borderRadius: 12,\n          padding: \"14px 16px\",\n          marginBottom: 10,\n          backgroundColor: \"#ffffff\",\n          boxShadow: \"0 1px 3px rgba(0,0,0,0.1)\",\n          transition: \"all 0.2s ease\",\n          position: \"relative\",\n          borderLeft: `4px solid ${meta.color}`,\n        }}\n      >\n        {/* Header du bloc */}\n        <div\n          style={{\n            display: \"flex\",\n            justifyContent: \"space-between\",\n            alignItems: \"flex-start\",\n            gap: 12,\n            marginBottom: isCollapsed ? 0 : 10,\n          }}\n        >\n          <div style={{ display: \"flex\", alignItems: \"center\", gap: 10, flex: 1 }}>\n            {supportsCollapse ? (\n              <button\n                type=\"button\"\n                onClick={() =>\n                  setCollapsedBlocks((prev) => ({\n                    ...prev,\n                    [block.id]: !prev[block.id],\n                  }))\n                }\n                style={{\n                  border: \"1px solid #cbd5f5\",\n                  backgroundColor: isCollapsed ? \"#e0e7ff\" : \"#fff\",\n                  color: \"#3b82f6\",\n                  width: 28,\n                  height: 28,\n                  borderRadius: 6,\n                  display: \"flex\",\n                  alignItems: \"center\",\n                  justifyContent: \"center\",\n                  cursor: \"pointer\",\n                  fontSize: 14,\n                }}\n              >\n                {isCollapsed ? \"‚ñ∏\" : \"‚ñæ\"}\n              </button>\n            ) : (\n              <div style={{ width: 28, height: 28 }} />\n            )}\n            <div\n              {...(handleProps ?? {})}\n              style={{\n                cursor: \"grab\",\n                padding: \"6px 8px\",\n                borderRadius: 6,\n                backgroundColor: \"#f1f5f9\",\n                display: \"flex\",\n                alignItems: \"center\",\n                justifyContent: \"center\",\n                color: \"#1e293b\",\n                fontSize: 12,\n                minWidth: 28,\n              }}\n              title=\"Glisser pour d√©placer\"\n            >\n              ‚ãÆ‚ãÆ\n            </div>\n            <div style={{ display: \"flex\", flexDirection: \"column\", gap: 4 }}>\n              <div style={{ display: \"flex\", alignItems: \"center\", gap: 8 }}>\n                <span style={{ fontSize: 20 }} aria-hidden>\n                  {meta.icon}\n                </span>\n                <span\n                  style={{\n                    fontSize: 13,\n                    fontWeight: 700,\n                    textTransform: \"uppercase\",\n                    letterSpacing: \"0.04em\",\n                    color: meta.color,\n                    fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                  }}\n                >\n                  {meta.label}\n                </span>\n              </div>\n              <span\n                style={{\n                  fontSize: 12,\n                  color: \"#64748b\",\n                  maxWidth: 420,\n                }}\n              >\n                {meta.description}\n              </span>\n            </div>\n          </div>\n\n          <div style={{ display: \"flex\", gap: 6, alignItems: \"center\" }}>\n            {canHaveChildren && (\n              <div style={{ display: \"flex\", alignItems: \"center\", gap: 6 }}>\n                <select\n                  value={subBlockTypes[block.id] || allowedChildTypes[0] || \"text\"}\n                  onChange={(e) =>\n                    setSubBlockTypes({\n                      ...subBlockTypes,\n                      [block.id]: e.target.value as BlockType,\n                    })\n                  }\n                  style={{\n                    padding: \"6px 8px\",\n                    borderRadius: 6,\n                    border: \"1px solid #d1d5db\",\n                    fontSize: 12,\n                    fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                  }}\n                  title=\"Choisir un type de sous-bloc\"\n                >\n                  {allowedChildTypes.map((t) => (\n                    <option key={t} value={t}>\n                      {getBlockMeta(t).label}\n                    </option>\n                  ))}\n                </select>\n                <button\n                  type=\"button\"\n                  onClick={() => handleAddBlock(block.id)}\n                  style={{\n                    ...actionButtonStyle,\n                    borderColor: \"#bfdbfe\",\n                    color: \"#1d4ed8\",\n                    backgroundColor: \"#eff6ff\",\n                  }}\n                >\n                  + Ajouter\n                </button>\n              </div>\n            )}\n\n            <button\n              type=\"button\"\n              onClick={() => handleDuplicateBlock(block.id)}\n              style={actionButtonStyle}\n              title=\"Dupliquer le bloc\"\n            >\n              ‚ßâ\n              <span>Copier</span>\n            </button>\n            <button\n              type=\"button\"\n              onClick={() => handleDeleteBlock(block.id)}\n              style={{\n                ...actionButtonStyle,\n                borderColor: \"#fecaca\",\n                color: \"#b91c1c\",\n                backgroundColor: \"#fff1f2\",\n              }}\n              title=\"Supprimer le bloc\"\n            >\n              ‚úï\n            </button>\n          </div>\n        </div>\n\n        {/* Contenu du bloc */}\n        {!isCollapsed && (\n          <div style={{ marginTop: 4 }}>\n          {block.type === \"divider\" ? (\n            <hr style={{ border: \"none\", borderTop: \"2px solid #e5e7eb\", margin: \"8px 0\" }} />\n          ) : block.type === \"contact\" ? (\n            <div style={{ display: \"flex\", flexDirection: \"column\", gap: 8 }}>\n              <input\n                placeholder=\"Email\"\n                value={block.content?.email || \"\"}\n                onChange={(e) => updateBlockContent(block.id, { ...block.content, email: e.target.value })}\n                style={{\n                  padding: \"10px 12px\",\n                  border: \"1px solid #d1d5db\",\n                  borderRadius: 6,\n                  maxWidth: \"640px\",\n                  backgroundColor: \"#f8fafc\",\n                  transition: \"border-color 0.2s ease, box-shadow 0.2s ease\",\n                }}\n                data-contact-input\n              />\n              <input\n                placeholder=\"T√©l√©phone\"\n                value={block.content?.phone || \"\"}\n                onChange={(e) => updateBlockContent(block.id, { ...block.content, phone: e.target.value })}\n                style={{\n                  padding: \"10px 12px\",\n                  border: \"1px solid #d1d5db\",\n                  borderRadius: 6,\n                  maxWidth: \"640px\",\n                  backgroundColor: \"#f8fafc\",\n                  transition: \"border-color 0.2s ease, box-shadow 0.2s ease\",\n                }}\n                data-contact-input\n              />\n              <input\n                placeholder=\"Adresse\"\n                value={block.content?.address || \"\"}\n                onChange={(e) => updateBlockContent(block.id, { ...block.content, address: e.target.value })}\n                style={{\n                  padding: \"10px 12px\",\n                  border: \"1px solid #d1d5db\",\n                  borderRadius: 6,\n                  maxWidth: \"640px\",\n                  backgroundColor: \"#f8fafc\",\n                  transition: \"border-color 0.2s ease, box-shadow 0.2s ease\",\n                }}\n                data-contact-input\n              />\n              <input\n                placeholder=\"LinkedIn\"\n                value={block.content?.linkedin || \"\"}\n                onChange={(e) => updateBlockContent(block.id, { ...block.content, linkedin: e.target.value })}\n                style={{\n                  padding: \"10px 12px\",\n                  border: \"1px solid #d1d5db\",\n                  borderRadius: 6,\n                  maxWidth: \"640px\",\n                  backgroundColor: \"#f8fafc\",\n                  transition: \"border-color 0.2s ease, box-shadow 0.2s ease\",\n                }}\n                data-contact-input\n              />\n            </div>\n          ) : block.type === \"subsection\" ? (\n            <div style={{ display: \"flex\", flexDirection: \"column\", gap: 8 }}>\n              <RichTextEditor\n                value={block.content?.title || \"\"}\n                onChange={(html) => updateBlockContent(block.id, { ...block.content, title: html })}\n                placeholder=\"Titre (ex: JCDecaux)\"\n                singleLine\n                style={{ maxWidth: \"600px\" }}\n              />\n\n              {/* Contr√¥les d‚Äôoption pour sous-titre et p√©riode */}\n              <div style={{ display: \"flex\", gap: 8 }}>\n                {hasMeaningfulText(block.content?.subtitle) || subtitleVisible[block.id] ? (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      const map = { ...subtitleVisible };\n                      delete map[block.id];\n                      setSubtitleVisible(map);\n                      updateBlockContent(block.id, { ...block.content, subtitle: \"\" });\n                    }}\n                    style={{ padding: \"4px 8px\", fontSize: 12, border: \"1px solid #d1d5db\", borderRadius: 4, background: \"#fff\", fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\" }}\n                  >\n                    Supprimer sous-titre\n                  </button>\n                ) : (\n                  <button\n                    type=\"button\"\n                    onClick={() => setSubtitleVisible({ ...subtitleVisible, [block.id]: true })}\n                    style={{ padding: \"4px 8px\", fontSize: 12, border: \"1px solid #d1d5db\", borderRadius: 4, background: \"#fff\", fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\" }}\n                  >\n                    + Sous-titre\n                  </button>\n                )}\n\n                {hasMeaningfulText(block.content?.period) || periodVisible[block.id] ? (\n                  <button\n                    type=\"button\"\n                    onClick={() => {\n                      const map = { ...periodVisible };\n                      delete map[block.id];\n                      setPeriodVisible(map);\n                      updateBlockContent(block.id, { ...block.content, period: \"\" });\n                    }}\n                    style={{ padding: \"4px 8px\", fontSize: 12, border: \"1px solid #d1d5db\", borderRadius: 4, background: \"#fff\", fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\" }}\n                  >\n                    Supprimer date\n                  </button>\n                ) : (\n                  <button\n                    type=\"button\"\n                    onClick={() => setPeriodVisible({ ...periodVisible, [block.id]: true })}\n                    style={{ padding: \"4px 8px\", fontSize: 12, border: \"1px solid #d1d5db\", borderRadius: 4, background: \"#fff\", fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\" }}\n                  >\n                    + Date\n                  </button>\n                )}\n              </div>\n\n              {(hasMeaningfulText(block.content?.subtitle) || subtitleVisible[block.id]) && (\n                <RichTextEditor\n                  value={block.content?.subtitle || \"\"}\n                  onChange={(html) => updateBlockContent(block.id, { ...block.content, subtitle: html })}\n                  placeholder=\"Sous-titre (ex: Data Scientist)\"\n                  singleLine\n                  style={{ maxWidth: \"600px\" }}\n                />\n              )}\n\n              {(hasMeaningfulText(block.content?.period) || periodVisible[block.id]) && (\n                <RichTextEditor\n                  value={block.content?.period || \"\"}\n                  onChange={(html) => updateBlockContent(block.id, { ...block.content, period: html })}\n                  placeholder=\"P√©riode (ex: 11/2024 -- 05/2025)\"\n                  singleLine\n                  style={{ fontStyle: \"italic\", maxWidth: \"600px\" }}\n                />\n              )}\n            </div>\n          ) : (\n            <RichTextEditor\n              value={(block.type === \"header\" || block.type === \"section\")\n                ? (block.content?.title || \"\")\n                : (typeof block.content === \"string\" ? block.content : \"\")}\n              onChange={(html) => {\n                if (block.type === \"header\" || block.type === \"section\") {\n                  updateBlockContent(block.id, { ...block.content, title: html });\n                } else {\n                  updateBlockContent(block.id, html);\n                }\n              }}\n              singleLine={block.type === \"header\"}\n              placeholder={block.type === \"header\" ? \"Nom complet\" : \n                           block.type === \"section\" ? \"Titre de section\" : \n                           \"Contenu du texte...\"}\n              style={{\n                fontSize: block.type === \"header\" ? 18 : 14,\n                maxWidth: isChildOfSubsection ? \"560px\" : \"640px\"\n              }}\n            />\n          )}\n        </div>\n        )}\n\n        {/* Zone de drop pour les enfants (toujours visible pour permettre d'y entrer) */}\n        {canHaveChildren && (\n          <Droppable \n            droppableId={block.id} \n            type=\"CHILD\" \n            isDropDisabled={\n              !!isSelfDragging || (draggingBlockType === \"subsection\" && block.type === \"subsection\")\n            }\n          >\n            {(provided, snapshot) => (\n              <div\n                ref={provided.innerRef}\n                {...provided.droppableProps}\n                style={{\n                  marginLeft: 16,\n                  marginTop: isCollapsed ? 0 : 12,\n                  paddingLeft: 12,\n                  borderLeft: \"2px solid #e5e7eb\",\n                  backgroundColor: snapshot.isDraggingOver ? \"#e0f2fe\" : \"transparent\",\n                  borderRadius: 6,\n                  minHeight: snapshot.isDraggingOver ? 32 : isCollapsed ? 12 : 28,\n                  transition: \"background-color 0.2s ease\"\n                }}\n              >\n                {!isCollapsed &&\n                  block.children?.map((child, index) => (\n                    <Draggable key={child.id} draggableId={child.id} index={index}>\n                      {(provided, snapshotChild) => (\n                        <div\n                          ref={provided.innerRef}\n                          {...provided.draggableProps}\n                        >\n                          {renderBlock(child, block.id, provided.dragHandleProps, snapshotChild.isDragging)}\n                        </div>\n                      )}\n                    </Draggable>\n                  ))}\n                {provided.placeholder}\n                {isCollapsed && block.children && block.children.length > 0 && (\n                  <div\n                    style={{\n                      fontSize: 12,\n                      color: \"#94a3b8\",\n                      fontStyle: \"italic\",\n                      padding: \"4px 0 6px\",\n                      fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                    }}\n                  >\n                    Contenu repli√©\n                  </div>\n                )}\n              </div>\n            )}\n          </Droppable>\n        )}\n      </div>\n    );\n  };\n\n  // -------------------\n  // Rendu principal\n  // -------------------\n  return (\n    <div style={{ padding: \"20px\", backgroundColor: \"#f8fafc\" }}>\n      {dragError && (\n        <div style={{\n          marginBottom: \"12px\",\n          padding: \"8px 12px\",\n          backgroundColor: \"#fef2f2\",\n          border: \"1px solid #fecaca\",\n          color: \"#b91c1c\",\n          borderRadius: 6,\n          fontSize: \"13px\",\n          fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\"\n        }}>\n          {dragError}\n        </div>\n      )}\n      <style>{`\n        .block-editor__pulse {\n          animation: blockEditorPulse 0.4s ease-in-out 0s 2 alternate;\n        }\n        @keyframes blockEditorPulse {\n          from { box-shadow: 0 0 0 rgba(59, 130, 246, 0.4); }\n          to { box-shadow: 0 0 0 6px rgba(59, 130, 246, 0.1); }\n        }\n        input[data-contact-input]:focus {\n          border-color: #3b82f6 !important;\n          box-shadow: 0 0 0 2px rgba(59, 130, 246, 0.14);\n          outline: none;\n        }\n      `}</style>\n\n      {/* Header avec instructions */}\n      <div\n        style={{\n          marginBottom: 24,\n          padding: \"18px 20px\",\n          backgroundColor: \"#fff\",\n          borderRadius: 12,\n          border: \"1px solid #e1e5e9\",\n          boxShadow: \"0 10px 30px rgba(15, 23, 42, 0.05)\",\n          display: \"flex\",\n          flexDirection: \"column\",\n          gap: 16,\n        }}\n      >\n        <div>\n          <h2\n            style={{\n              margin: 0,\n              color: \"#0f172a\",\n              fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n              fontSize: 20,\n              fontWeight: 700,\n            }}\n          >\n            Compose ton CV bloc par bloc\n          </h2>\n          <p\n            style={{\n              margin: \"6px 0 0 0\",\n              color: \"#475569\",\n              fontSize: 14,\n              fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n              lineHeight: 1.5,\n            }}\n          >\n            Ajoute les sections dont tu as besoin puis glisse‚Äëd√©pose pour tout r√©organiser. Les placements impossibles sont automatiquement bloqu√©s.\n          </p>\n        </div>\n\n        <div\n          style={{\n            display: \"flex\",\n            flexDirection: \"column\",\n            gap: 12,\n          }}\n        >\n          <span\n            style={{\n              fontSize: 13,\n              fontWeight: 600,\n              textTransform: \"uppercase\",\n              color: \"#3b82f6\",\n              letterSpacing: \"0.06em\",\n              fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n            }}\n          >\n            Ajouter un bloc rapidement\n          </span>\n          <div\n            style={{\n              display: \"grid\",\n              gridTemplateColumns: \"repeat(auto-fit, minmax(180px, 1fr))\",\n              gap: 12,\n            }}\n          >\n            {getAllowedChildTypesForParent(undefined).map((type) => {\n              const meta = getBlockMeta(type);\n              return (\n                <button\n                  key={type}\n                  type=\"button\"\n                  onClick={() => handleAddBlock(undefined, type)}\n                  style={{\n                    textAlign: \"left\",\n                    padding: \"14px 16px\",\n                    borderRadius: 10,\n                    border: \"1px solid #e2e8f0\",\n                    background: \"linear-gradient(135deg, rgba(248, 250, 252, 0.95), rgba(241, 245, 249, 0.95))\",\n                    cursor: \"pointer\",\n                    transition: \"transform 0.18s ease, box-shadow 0.18s ease\",\n                    display: \"flex\",\n                    flexDirection: \"column\",\n                    gap: 8,\n                    fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                  }}\n                  onMouseEnter={(e) => {\n                    (e.currentTarget as HTMLButtonElement).style.transform = \"translateY(-2px)\";\n                    (e.currentTarget as HTMLButtonElement).style.boxShadow = \"0 12px 24px rgba(15, 23, 42, 0.08)\";\n                  }}\n                  onMouseLeave={(e) => {\n                    (e.currentTarget as HTMLButtonElement).style.transform = \"translateY(0)\";\n                    (e.currentTarget as HTMLButtonElement).style.boxShadow = \"none\";\n                  }}\n                >\n                  <span style={{ fontSize: 22 }} aria-hidden>\n                    {meta.icon}\n                  </span>\n                  <div>\n                    <div\n                      style={{\n                        fontWeight: 700,\n                        color: meta.color,\n                        fontSize: 14,\n                      }}\n                    >\n                      {meta.label}\n                    </div>\n                    <p\n                      style={{\n                        margin: \"4px 0 0 0\",\n                        fontSize: 12,\n                        color: \"#64748b\",\n                        lineHeight: 1.4,\n                      }}\n                    >\n                      {meta.description}\n                    </p>\n                  </div>\n                </button>\n              );\n            })}\n          </div>\n        </div>\n      </div>\n\n      {/* Zone de drop principale */}\n      <DragDropContext onDragEnd={handleDragEnd} onDragStart={handleDragStart}>\n        <Droppable droppableId=\"root\" type=\"ROOT\" isDropDisabled={draggingBlockType === \"subsection\"}>\n          {(provided, snapshot) => (\n            <div\n              ref={provided.innerRef}\n              {...provided.droppableProps}\n              style={{\n                minHeight: \"400px\",\n                backgroundColor: snapshot.isDraggingOver ? \"#f0f9ff\" : \"transparent\",\n                borderRadius: \"8px\",\n                padding: snapshot.isDraggingOver ? \"16px\" : \"0\",\n                border: snapshot.isDraggingOver ? \"2px dashed #3b82f6\" : \"none\",\n                transition: \"all 0.2s ease\"\n              }}\n            >\n              {blocks.length === 0 ? (\n                <div style={{\n                  textAlign: \"center\",\n                  padding: \"40px\",\n                  color: \"#9ca3af\",\n                  fontSize: \"16px\"\n                }}>\n                  Aucun bloc. Ajoutez votre premier bloc pour commencer.\n                </div>\n              ) : (\n                blocks.map((block, index) => (\n                  <Draggable key={block.id} draggableId={block.id} index={index}>\n                    {(provided, snapshot) => (\n                      <div\n                        ref={provided.innerRef}\n                        {...provided.draggableProps}\n                        style={{\n                          ...provided.draggableProps.style,\n                          opacity: snapshot.isDragging ? 0.8 : 1,\n                        }}\n                      >\n                        {renderBlock(block, undefined, provided.dragHandleProps, snapshot.isDragging)}\n                      </div>\n                    )}\n                  </Draggable>\n                ))\n              )}\n              {provided.placeholder}\n              \n              {snapshot.isDraggingOver && (\n                <div style={{\n                  textAlign: \"center\",\n                  padding: \"20px\",\n                  color: \"#3b82f6\",\n                  fontSize: \"14px\",\n                  fontWeight: \"500\"\n                }}>\n                  D√©posez le bloc ici\n                </div>\n              )}\n            </div>\n          )}\n        </Droppable>\n      </DragDropContext>\n    </div>\n  );\n};\n\nexport default BlockEditor;\n","import { Block } from \"./types\";\n\nexport default function blocksToHTML(blocks: Block[], fontScale: number = 1): string {\n    const render = (list: Block[], depth: number): string =>\n      list.map(block => {\n      switch (block.type) {\n        case \"header\": {\n          const text = block.content?.title || \"\";\n          return `<div class=\"cv-header\"><div class=\"cv-name\">${text}</div></div>`;\n        }\n  \n        case \"contact\": {\n          const c = block.content || {};\n          const parts = [c.email, c.phone, c.address, c.linkedin].filter(Boolean).join(\" ‚Ä¢ \");\n          return `<div class=\"cv-contact\">${parts}</div>`;\n        }\n  \n        case \"text\": {\n          const raw = block.content || \"\";\n          // enlever les balises pour les heuristiques simples\n          const plain = typeof raw === \"string\" ? raw.replace(/<[^>]*>/g, \"\").replace(/\\u00A0/g, \" \") : \"\";\n          const hasLetter = /[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø]/.test(plain);\n          const isIntro = /√âtudiant\\s+√†\\s+IMT\\s+Atlantique/i.test(plain);\n          const hasListTag = typeof raw === \"string\" && /<(ul|ol)\\b/i.test(raw);\n          const hasLineBreaks = typeof raw === \"string\" && /<br\\s*\\/?\\s*>/i.test(raw);\n\n          // Si bloc totalement vide (aucune lettre), ne rien rendre (pas d'espace)\n          if (!hasLetter && !hasListTag) {\n            return `${render(block.children || [], depth + 1)}`;\n          }\n\n          if (isIntro) {\n            return `<div class=\"cv-intro\">${raw}</div>${render(block.children || [], depth + 1)}`;\n          }\n\n          // Conserver les listes natives UL/OL si pr√©sentes\n          if (hasListTag) {\n            return `<div class=\"cv-text\">${raw}</div>${render(block.children || [], depth + 1)}`;\n          }\n\n          // Support multi-lignes dans un seul bloc texte via <br>\n          if (hasLineBreaks) {\n            const parts = (raw as string).split(/<br\\s*\\/?\\s*>/i);\n            const htmlLines = parts\n              .map((line) => {\n                const plainLine = line.replace(/<[^>]*>/g, \"\").replace(/\\u00A0/g, \" \").trim();\n                if (!/[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø]/.test(plainLine)) return \"\"; // ignorer ligne vide\n                const isBulletLine = /^\\s*[‚Ä¢\\-‚Äì]/.test(plainLine);\n                const cleaned = isBulletLine ? line.replace(/^\\s*[‚Ä¢\\-‚Äì]\\s*/, \"\") : line;\n                const levelClass = depth >= 2 ? \" cv-bullet--level2\" : \"\";\n                if (isBulletLine) {\n                  return `<div class=\\\"cv-text cv-bullet${levelClass}\\\">${cleaned}</div>`;\n                }\n                return `<div class=\\\"cv-text\\\">${line}</div>`;\n              })\n              .filter(Boolean)\n              .join(\"\");\n            return `${htmlLines}${render(block.children || [], depth + 1)}`;\n          }\n\n          // Ligne simple\n          const isBullet = /^\\s*[‚Ä¢\\-‚Äì]/.test(plain);\n          const cleaned = isBullet && typeof raw === \"string\" ? raw.replace(/^\\s*[‚Ä¢\\-‚Äì]\\s*/, \"\") : raw;\n          const levelClass = depth >= 2 ? \" cv-bullet--level2\" : \"\";\n          if (isBullet) {\n            return `<div class=\"cv-text cv-bullet${levelClass}\">${cleaned}</div>${render(block.children || [], depth + 1)}`;\n          }\n          return `<div class=\"cv-text\">${raw}</div>${render(block.children || [], depth + 1)}`;\n        }\n  \n        case \"divider\":\n          return `<hr class=\"cv-divider\"/>`;\n  \n        case \"section\":\n          return `<div class=\"cv-section\">\\n            <div class=\"cv-section-title\">${block.content?.title || \"\"}</div>\\n            ${render(block.children || [], depth + 1)}\\n          </div>`;\n  \n        case \"subsection\": {\n          const title = block.content?.title || \"\";\n          const subtitle = block.content?.subtitle || \"\";\n          const period = block.content?.period || \"\";\n          const childrenHtml = render(block.children || [], depth + 1);\n          const childPlain = childrenHtml.replace(/<[^>]*>/g, \"\").replace(/\\u00A0/g, \" \").trim();\n          const childrenHasLetters = /[A-Za-z√Ä-√ñ√ò-√∂√∏-√ø]/.test(childPlain);\n\n          // Si aucun contenu enfant avec lettres, masquer enti√®rement la sous-section\n          if (!childrenHasLetters) {\n            return \"\";\n          }\n\n          return `<div class=\\\"cv-subsection\\\">\\n            <div class=\\\"cv-subsection-header\\\">\\n              <div>\\n                <div class=\\\"cv-subsection-title\\\">${title}</div>\\n                ${subtitle ? `<div class=\\\\\\\"cv-subsection-subtitle\\\\\\\">${subtitle}</div>` : \"\"}\\n              </div>\\n              ${period ? `<div class=\\\\\\\"cv-subsection-period\\\\\\\">${period}</div>` : \"\"}\\n            </div>\\n            ${childrenHtml}\\n          </div>`;\n        }\n  \n        default:\n          return \"\";\n      }\n      }).join(\"\");\n\n    // envelopper dans un conteneur .cv pour appliquer les styles globaux\n    return `<div class=\"cv\">${render(blocks, 0)}</div>`;\n  }\n  ","export function getCvCss(fontScale: number = 1): string {\n  const fs10 = 10 * fontScale; // base body font size in pt\n  const fs12 = 12 * fontScale;\n  const fs18 = 18 * fontScale;\n  const gap8 = 8 * fontScale;\n  const gap4 = 4 * fontScale;\n  const gap2 = 2 * fontScale;\n  const indent1 = 16 * fontScale;\n  const indent2 = 22 * fontScale;\n\n  return `\n  /* Page and typography */\n  @page { size: A4; margin: 15mm; }\n  .cv { font-family: 'Times New Roman', Times, serif; font-size: ${fs10}pt; line-height: 1.25; color: #000; }\n  .cv h1, .cv h2, .cv h3, .cv h4, .cv p { margin: 0; padding: 0; }\n  .cv a { color: inherit; text-decoration: underline; }\n\n  /* Header */\n  .cv .cv-header { text-align: center; margin-bottom: ${gap8}px; }\n  .cv .cv-name { font-size: ${fs18}pt; font-weight: 700; }\n  .cv .cv-contact { text-align: center; font-size: ${fs10}pt; margin-top: ${gap2}px; }\n  .cv .cv-intro { text-align: center; font-style: italic; margin-bottom: ${gap8}px; }\n\n  /* Sections */\n  .cv .cv-section { margin-top: ${gap8}px; }\n  .cv .cv-section-title { font-size: ${fs12}pt; text-transform: uppercase; margin: 0 0 ${gap4}px 0; padding-bottom: ${gap2}px; border-bottom: 0.5pt solid #000; }\n\n  /* Subsections */\n  .cv .cv-subsection { margin-bottom: ${gap4}px; }\n  .cv .cv-subsection-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: ${gap2}px; column-gap: ${gap4}px; }\n  .cv .cv-subsection-title { font-size: ${fs10}pt; font-weight: 600; }\n  .cv .cv-subsection-subtitle { font-size: ${fs10}pt; margin-top: ${Math.max(1 * fontScale, 1)}px; }\n  .cv .cv-subsection-period { font-size: ${fs10}pt; font-style: italic; white-space: nowrap; }\n\n  /* Text and bullets */\n  .cv .cv-text { font-size: ${fs10}pt; margin-bottom: ${gap2}px; }\n  .cv .cv-bullet { position: relative; padding-left: ${indent1}px; }\n  .cv .cv-bullet::before { content: \"‚Äì\"; position: absolute; left: 0; top: 0; }\n  .cv .cv-bullet--level2 { padding-left: ${indent2}px; }\n  .cv .cv-bullet--level2::before { content: \"‚Ä¢\"; }\n\n  /* Divider */\n  .cv hr.cv-divider { border: 0; border-top: 0.5pt solid #000; margin: ${gap8}px 0; }\n  `;\n}\n\nexport default getCvCss;\n\n","import { v4 as uuidv4 } from \"uuid\";\nimport { Block } from \"../utils/types\";\n\nexport const initialBlocks: Block[] = [\n  {\n    id: uuidv4(),\n    type: \"header\",\n    content: { title: \"Charles Pelong\" },\n    style: { size: \"large\", align: \"center\" },\n  },\n  {\n    id: uuidv4(),\n    type: \"contact\",\n    content: {\n      email: \"charlespelong@gmail.com\",\n      phone: \"+33 7 83 28 54 92\",\n      address: \"31 Avenue de Verdun, 78290 Croissy-sur-Seine\",\n      linkedin: \"<a href=\\\"https://fr.linkedin.com/in/charles-pelong-a68212246\\\">linkedin</a>\",\n    },\n  },\n  {\n    id: uuidv4(),\n    type: \"text\",\n    content:\n      \"<em>√âtudiant √† IMT Atlantique √† la recherche d‚Äôun <strong>stage de fin d‚Äô√©tudes</strong> √† partir du <strong>04/2026</strong> dans le domaine de la <strong>science des donn√©es</strong> et de l'<strong>apprentissage automatique</strong>.</em>\",\n  },\n  {\n    id: uuidv4(),\n    type: \"divider\"\n  },\n  {\n    id: uuidv4(),\n    type: \"section\",\n    content: { title: \"FORMATIONS\" },\n    children: [\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"IMT Atlantique ‚Äî Master : Data Science et Recherche Op√©rationnelle\",\n          subtitle: \"\",\n          period: \"09/2022 -- 06/2025\",\n        },\n        children: [\n          {\n            id: uuidv4(),\n            type: \"text\",\n            content:\n              \"‚Ä¢ <strong>#3 √©cole d‚Äôing√©nieurs fran√ßaise</strong>, d'apr√®s le <a href=\\\"https://www.letudiant.fr/classements/classement-des-ecoles-d-ingenieurs.html\\\">\\\"Classement de l‚ÄôEtudiant 2025\\\"</a><br/>‚Ä¢ Cours : Math√©matiques appliqu√©es, Statistiques, Probabilit√©s, Machine Learning, Optimisation, Recherche op√©rationnelle, IA, Python, Java, Anglais\",\n          },\n        ],\n      },\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"Shanghai Jiao Tong University ‚Äî Master en Informatique et Recherche Op√©rationnelle\",\n          subtitle: \"\",\n          period: \"09/2022 -- 06/2025\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ <strong>#9 universit√© mondiale</strong> en <strong>Computer Science</strong>, d'apr√®s le <a href=\\\"https://www.shanghairanking.com/rankings/gras/2024/RS0210\\\">\\\"Classement de Shanghai 2025\\\"</a><br/>‚Ä¢ Cours : Deep Learning, Computer Vision, Machine Learning, Cloud Computing, Chinois\" },\n        ],\n      },\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"Lyc√©e Pasteur ‚Äî Classes pr√©paratoires scientifiques PCSI/PC (CPGE)\",\n          subtitle: \"\",\n          period: \"09/2020 -- 07/2022\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ Formation intensive en Math√©matiques, Physique, Chimie, Informatique, Fran√ßais, Anglais\" },\n        ],\n      },\n    ],\n  },\n  {\n    id: uuidv4(),\n    type: \"divider\"\n  },\n  {\n    id: uuidv4(),\n    type: \"section\",\n    content: { title: \"EXPERIENCES PROFESSIONNELLES\" },\n    children: [\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"JCDecaux ‚Äî Data Scientist\",\n          subtitle: \"\",\n          period: \"11/2024 -- 05/2025\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"<em>Stage de 6 mois au sein de la DataCorp, entit√© de JCDecaux d√©veloppant des produits data</em>\" },\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ D√©veloppement de solutions RAG (Retrieval-Augmented Generation) as-a-service (Python, AWS, Langchain). Cr√©ation de <strong>copilotes IA</strong> √† destination :<br/>‚Ä¢ des commerciaux pour un acc√®s rapide √† des donn√©es cibl√©es et fiables du groupe pour l'<strong>√©laboration de devis</strong>.<br/>‚Ä¢ de la direction financi√®re permettant la <strong>cr√©ation de tableaux de bord √† partir du langage naturel</strong> bas√©s sur les donn√©es du groupe.\" },\n          { id: uuidv4(), type: \"text\", content: \"Ces produits permettent de <strong>r√©duire drastiquement le temps</strong> de recherche et les frottements entre diff√©rentes entit√©s du groupe.\" },\n        ],\n      },\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"Sopra Steria Next ‚Äî Data Analyst / Data Engineer\",\n          subtitle: \"\",\n          period: \"04/2024 -- 10/2024\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"<em>Stage de 6 mois, mission de conseil orient√©e data pour le compte du Minist√®re de l‚ÄôInt√©rieur</em>\" },\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ Collecte et traitement de donn√©es incluant du <strong>web scraping</strong> et <strong>extraction</strong> depuis diverses sources (Python, Selenium).<br/>‚Ä¢ Cr√©ation de pipelines de donn√©es pour automatiser l‚Äô<strong>int√©gration</strong> et le <strong>nettoyage</strong> (Python, Pandas, M/Power BI).<br/>‚Ä¢ Production de <strong>tableaux de bord</strong> et <strong>rapports automatis√©s</strong> pour suivre les indicateurs de performance (Power BI, Python).\" },\n        ],\n      },\n    ],\n  },\n  {\n    id: uuidv4(),\n    type: \"divider\"\n  },\n  {\n    id: uuidv4(),\n    type: \"section\",\n    content: { title: \"AUTRES EXPERIENCES\" },\n    children: [\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"Junior Atlantique ‚Äì Timber Productions ‚Äî D√©veloppeur logiciel\",\n          subtitle: \"\",\n          period: \"05/2023 -- 10/2023\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ D√©veloppement complet d‚Äôune application de gestion et recherche de contacts clients (JavaScript).<br/>‚Ä¢ Vente de l‚Äôapplication pour <strong>3 000‚Ç¨</strong>.\" },\n        ],\n      },\n      {\n        id: uuidv4(),\n        type: \"subsection\",\n        content: {\n          title: \"Reeverse Systems ‚Äî Chef de projet\",\n          subtitle: \"\",\n          period: \"09/2023 -- 01/2024\",\n        },\n        children: [\n          { id: uuidv4(), type: \"text\", content: \"<em>Projet acad√©mique de 4 mois avec Reeverse Systems, √©laboration d'un simulateur pour d√©montrer <br/> l‚Äôefficacit√© de leur solution : r√©duction des d√©chets industriels et maximisation des rendements.</em>\" },\n          { id: uuidv4(), type: \"text\", content: \"‚Ä¢ Conception d‚Äôun simulateur multi-objectifs pour la production industrielle (Python, Matplotlib) :<br/>‚Ä¢ G√©n√©ration de donn√©es al√©atoires suivant diff√©rentes lois pour simuler plusieurs facteurs (nombre d‚Äôouvriers, poids des d√©chets, etc.).<br/>‚Ä¢ Cr√©ation de <strong>fronts de Pareto</strong> et visualisation sous forme de <strong>graphes radar</strong> (Python, Matplotlib).<br/>‚Ä¢ Clustering <strong>K-means</strong> sur le front de Pareto pour ne pr√©senter que 5 solutions repr√©sentatives.\" },\n        ],\n      },\n    ],\n  },\n  {\n    id: uuidv4(),\n    type: \"divider\"\n  },\n  {\n    id: uuidv4(),\n    type: \"section\",\n    content: { title: \"COMPETENCES, LANGUES ET ACTIVITES\" },\n    children: [\n      { id: uuidv4(), type: \"text\", content: \"<strong>Langues :</strong> Fran√ßais (natif), Anglais (IELTS 7/9), Espagnol (A2), Allemand (A2)<br/><strong>Programmation :</strong> Python (Pandas, Scikit-learn), SQL, GitHub, Java, JavaScript, M/Power BI<br/><strong>Machine Learning :</strong> Kaggle competitions (stacking LGBM+CatBoost sur les prix de voitures d‚Äôoccasion), √©tude de cas <a href=\\\"https://colab.research.google.com/drive/1onv9AMOuMZQ_lIy7tBFuBrV1Pg3gU0fa#scrollTo=166cd074-f8c4-4f9d-9787-275a2a4e08af\\\">Roland Berger</a> (cliniques dentaires)<br/><strong>Sports :</strong> Judo, Rugby (capitaine et responsable de l‚Äô√©quipe de l‚Äô√©cole)<br/><strong>B√©n√©volat :</strong> Scouts (10 ans) + mission humanitaire (1 mois)\" },\n    ],\n  },\n];\n","import { useState, useEffect, useRef, useCallback } from \"react\";\nimport type { GetServerSidePropsContext } from \"next\";\nimport { createPagesServerClient } from \"@supabase/auth-helpers-nextjs\";\nimport DynamicHeader from \"../components/DynamicHeader\";\nimport { Panel, PanelGroup, PanelResizeHandle } from \"react-resizable-panels\";\nimport BlockEditor from \"../components/BlockEditor\";\nimport blocksToHTML from \"../utils/blocksToHTML\";\nimport getCvCss from \"../utils/cvStyles\";\nimport { initialBlocks } from \"../data/initialCV\";\nimport { Block } from \"../utils/types\";\n\n// Styles CSS pour la responsivit√©\nconst styles = `\n  .preview-cv {\n    transform: scale(0.8);\n    transform-origin: top center;\n  }\n  \n  @media (max-width: 1200px) {\n    .preview-cv {\n      transform: scale(0.6) !important;\n    }\n  }\n  \n  @media (max-width: 768px) {\n    .preview-cv {\n      transform: scale(0.5) !important;\n    }\n  }\n`;\n\nexport default function CvGeneratorPage() {\n  console.log(\"CvGeneratorPage component rendered\");\n  \n  // IDs stables: charger depuis localStorage si disponible\n  const [blocks, setBlocks] = useState<Block[]>([]);\n  const [fontScale, setFontScale] = useState<number>(1);\n  const [showWarning, setShowWarning] = useState<boolean>(false);\n  const previewRef = useRef<HTMLDivElement>(null);\n  const editorScrollRef = useRef<HTMLDivElement>(null);\n\n  // Charger/Sauvegarder les blocs pour stabiliser les IDs (√©viter HMR qui reg√©n√®re)\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    try {\n      const stored = window.localStorage.getItem(\"cv_blocks\");\n      if (stored) {\n        const parsed = JSON.parse(stored) as Block[];\n        setBlocks(parsed);\n      } else {\n        setBlocks(initialBlocks);\n        window.localStorage.setItem(\"cv_blocks\", JSON.stringify(initialBlocks));\n      }\n    } catch {\n      setBlocks(initialBlocks);\n    }\n  }, []);\n\n  useEffect(() => {\n    if (typeof window === \"undefined\") return;\n    try {\n      window.localStorage.setItem(\"cv_blocks\", JSON.stringify(blocks));\n    } catch {}\n  }, [blocks]);\n\n  // Calcul de la taille optimale\n  const calculateOptimalFontScale = useCallback(() => {\n    if (!previewRef.current) return 1;\n  \n    const maxHeight = 1050;\n    let scale = 1;\n  \n    const tempDiv = document.createElement(\"div\");\n    tempDiv.style.width = \"210mm\";\n    tempDiv.style.padding = \"15mm\";\n    tempDiv.style.boxSizing = \"border-box\";\n    tempDiv.style.position = \"absolute\";\n    tempDiv.style.visibility = \"hidden\";\n    document.body.appendChild(tempDiv);\n  \n    let currentScale = 1;\n    const step = 0.02;\n    while (currentScale > 0.5) {\n      tempDiv.innerHTML = `<style>${getCvCss(currentScale)}</style>` + blocksToHTML(blocks, currentScale);\n      const contentHeight = tempDiv.scrollHeight;\n  \n      if (contentHeight <= maxHeight) {\n        scale = currentScale;\n        break;\n      }\n      currentScale -= step;\n    }\n  \n    document.body.removeChild(tempDiv);\n    return scale;\n  }, [blocks]);\n\n  // V√©rifier le d√©passement √† chaque changement de blocks avec d√©lai\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      const scale = calculateOptimalFontScale();\n      setFontScale(scale);\n      setShowWarning(scale < 1);\n    }, 100);\n    \n    return () => clearTimeout(timer);\n  }, [calculateOptimalFontScale]);\n\n  const handleGeneratePDF = async () => {\n    console.log(\"Generating PDF...\", { blocks, fontScale });\n    try {\n      console.log(\"Making fetch request to /api/generate-pdf\");\n      const res = await fetch(\"/api/generate-pdf\", {\n        method: \"POST\",\n        headers: { \"Content-Type\": \"application/json\" },\n        body: JSON.stringify({ blocks, fontScale }),\n      });\n\n      console.log(\"Response received:\", res.status, res.statusText);\n\n      if (!res.ok) {\n        const errorData = await res.json();\n        console.error(\"API Error:\", errorData);\n        throw new Error(errorData.error || `HTTP error! status: ${res.status}`);\n      }\n\n      console.log(\"Converting response to blob\");\n      const blob = await res.blob();\n      console.log(\"Blob created:\", blob.size, \"bytes\");\n      \n      const url = URL.createObjectURL(blob);\n      const link = document.createElement('a');\n      link.href = url;\n      link.download = 'mon-cv.pdf';\n      document.body.appendChild(link);\n      link.click();\n      document.body.removeChild(link);\n      URL.revokeObjectURL(url);\n      console.log(\"PDF download initiated\");\n    } catch (error) {\n      console.error(\"Erreur lors de la g√©n√©ration du PDF:\", error);\n      alert(`Erreur lors de la g√©n√©ration du PDF: ${error instanceof Error ? error.message : \"Erreur inconnue\"}`);\n    }\n  };\n\n  return (\n    <>\n      <style>{styles}</style>\n      <style>{getCvCss(fontScale)}</style>\n\n      <DynamicHeader \n        variant=\"landing\" \n        scrollContainerRef={editorScrollRef as React.RefObject<HTMLDivElement>}\n      />\n\n      <PanelGroup direction=\"horizontal\" style={{ height: \"100vh\" }}>\n        {/* Partie gauche - √âditeur (scrollable) */}\n        <Panel defaultSize={60} minSize={30} maxSize={80}>\n          <div style={{ \n            height: \"100%\", \n            padding: \"1rem\",\n            overflow: \"auto\"\n          }} ref={editorScrollRef}>\n            <BlockEditor blocks={blocks} setBlocks={setBlocks} scrollContainerRef={editorScrollRef} />\n          </div>\n        </Panel>\n        \n        {/* S√©parateur redimensionnable */}\n        <PanelResizeHandle \n          style={{\n            width: \"8px\",\n            backgroundColor: \"#e1e5e9\",\n            cursor: \"col-resize\",\n            display: \"flex\",\n            alignItems: \"center\",\n            justifyContent: \"center\"\n          }}\n        >\n          <div style={{\n            width: \"2px\",\n            height: \"40px\",\n            backgroundColor: \"#9ca3af\",\n            borderRadius: \"1px\"\n          }} />\n        </PanelResizeHandle>\n        \n        {/* Partie droite - Aper√ßu (fixe) */}\n        <Panel defaultSize={50} minSize={45} maxSize={60}>\n          <div style={{ \n            height: \"100vh\",\n            overflow: \"hidden\",\n            backgroundColor: \"#f8fafc\",\n            padding: \"0.5rem\",\n            borderLeft: \"1px solid #e1e5e9\",\n            display: \"flex\",\n            flexDirection: \"column\"\n          }}>\n            {/* Zone de scroll pour l'aper√ßu CV */}\n            <div style={{ \n              flex: 1,\n              overflow: \"auto\",\n              marginBottom: \"0.5rem\"\n            }}>\n              {/* Bouton fixe en bas - toujours visible */}\n              <div style={{ \n                display: \"flex\", \n                flexDirection: \"column\",\n                gap: \"8px\",\n                backgroundColor: \"#fff\",\n                padding: \"1rem\",\n                borderRadius: \"8px\",\n                border: \"1px solid #e1e5e9\",\n                boxShadow: \"0 2px 4px rgba(0,0,0,0.1)\",\n                flexShrink: 0,\n                marginBottom: \"10px\",\n                position: \"relative\",\n                zIndex: 20\n              }}>\n                <button \n                  onClick={() => {\n                    console.log(\"PDF Button clicked!\");\n                    handleGeneratePDF();\n                  }}\n                  style={{\n                    padding: \"12px 16px\",\n                    backgroundColor: \"#3b82f6\",\n                    color: \"white\",\n                    border: \"none\",\n                    borderRadius: \"6px\",\n                    cursor: \"pointer\",\n                    fontSize: \"14px\",\n                    fontWeight: \"600\",\n                    fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                    position: \"relative\",\n                    zIndex: 21,\n                    pointerEvents: \"auto\"\n                  }}\n                >\n                  G√©n√©rer PDF\n                </button>\n              </div>\n\n              {showWarning && (\n                <div style={{\n                  backgroundColor: \"#fff3cd\",\n                  border: \"1px solid #ffeaa7\",\n                  borderRadius: \"4px\",\n                  padding: \"8px 12px\",\n                  margin: \"10px 0\",\n                  color: \"#856404\",\n                  fontSize: \"14px\",\n                  fontFamily: \"'Inter', -apple-system, BlinkMacSystemFont, sans-serif\",\n                  fontWeight: \"500\"\n                }}>\n                  ‚ö†Ô∏è Attention : Tu d√©passes la premi√®re page ! La taille de police a √©t√© r√©duite √† {Math.round(fontScale * 100)}% pour tenir sur une page.\n                </div>\n              )}\n              \n              <div style={{ \n              }}>\n                <div\n                  ref={previewRef}\n                  className=\"preview-cv\"\n                  style={{\n                    width: \"210mm\",\n                    minHeight: \"297mm\",\n                    padding: \"15mm\",\n                    border: \"1px solid #000\",\n                    boxSizing: \"border-box\",\n                    backgroundColor: \"#fff\",\n                    transform: \"scale(0.8)\",\n                    transformOrigin: \"top left\",\n                    marginBottom: \"0.1rem\"\n                  }}\n                  dangerouslySetInnerHTML={{ __html: blocksToHTML(blocks, fontScale) }}\n                />\n              </div>\n            </div>\n        \n          </div>\n        </Panel>\n       </PanelGroup>\n     </>\n  );\n}\n\nexport async function getServerSideProps(context: GetServerSidePropsContext) {\n  const supabase = createPagesServerClient(context)\n  const {\n    data: { session },\n  } = await supabase.auth.getSession()\n\n  if (!session) {\n    const redirectDestination = `/login?redirect=${encodeURIComponent(context.resolvedUrl ?? '/cv')}`\n\n    return {\n      redirect: {\n        destination: redirectDestination,\n        permanent: false,\n      },\n    }\n  }\n\n  return {\n    props: {\n      initialSession: session,\n    },\n  }\n}\n","import { PagesRouteModule } from '../../server/route-modules/pages/module.compiled'\nimport { RouteKind } from '../../server/route-kind'\n\nimport { hoist } from './helpers'\n\n// Import the app and document modules.\nimport * as document from 'VAR_MODULE_DOCUMENT'\nimport * as app from 'VAR_MODULE_APP'\n\n// Import the userland code.\nimport * as userland from 'VAR_USERLAND'\nimport { getHandler } from '../../server/route-modules/pages/pages-handler'\n\n// Re-export the component (should be the default export).\nexport default hoist(userland, 'default')\n\n// Re-export methods.\nexport const getStaticProps = hoist(userland, 'getStaticProps')\nexport const getStaticPaths = hoist(userland, 'getStaticPaths')\nexport const getServerSideProps = hoist(userland, 'getServerSideProps')\nexport const config = hoist(userland, 'config')\nexport const reportWebVitals = hoist(userland, 'reportWebVitals')\n\n// Re-export legacy methods.\nexport const unstable_getStaticProps = hoist(\n  userland,\n  'unstable_getStaticProps'\n)\nexport const unstable_getStaticPaths = hoist(\n  userland,\n  'unstable_getStaticPaths'\n)\nexport const unstable_getStaticParams = hoist(\n  userland,\n  'unstable_getStaticParams'\n)\nexport const unstable_getServerProps = hoist(\n  userland,\n  'unstable_getServerProps'\n)\nexport const unstable_getServerSideProps = hoist(\n  userland,\n  'unstable_getServerSideProps'\n)\n\n// Create and export the route module that will be consumed.\nexport const routeModule = new PagesRouteModule({\n  definition: {\n    kind: RouteKind.PAGES,\n    page: 'VAR_DEFINITION_PAGE',\n    pathname: 'VAR_DEFINITION_PATHNAME',\n    // The following aren't used in production.\n    bundlePath: '',\n    filename: '',\n  },\n  distDir: process.env.__NEXT_RELATIVE_DIST_DIR || '',\n  relativeProjectDir: process.env.__NEXT_RELATIVE_PROJECT_DIR || '',\n  components: {\n    // default export might not exist when optimized for data only\n    App: app.default,\n    Document: document.default,\n  },\n  userland,\n})\n\nexport const handler = getHandler({\n  srcPage: 'VAR_DEFINITION_PAGE',\n  config,\n  userland,\n  routeModule,\n  getStaticPaths,\n  getStaticProps,\n  getServerSideProps,\n})\n"],"names":["PagesRouteModule","RouteKind","hoist","document","app","userland","getHandler","getStaticProps","getStaticPaths","getServerSideProps","config","reportWebVitals","unstable_getStaticProps","unstable_getStaticPaths","unstable_getStaticParams","unstable_getServerProps","unstable_getServerSideProps","routeModule","definition","kind","PAGES","page","pathname","bundlePath","filename","distDir","process","env","__NEXT_RELATIVE_DIST_DIR","relativeProjectDir","__NEXT_RELATIVE_PROJECT_DIR","components","App","default","Document","handler","srcPage"],"mappings":"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","ignoreList":[6]}